<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/figma-plugin-ds@1.0.1/dist/figma-plugin-ds.css">
<style>
    body {
        padding: 1em;
        background-color: var(--figma-color-bg);
        color: var(--figma-color-text);
    }

    input {
        display: block;
    }

    .width-100 {
        width: 100%;
    }

    .flex {
        display: flex;
    }

    .flex-row {
        flex-direction: row;
        flex-wrap: wrap;
    }

    .flex button {
        margin-left: 0.5em;
    }

    .flex button:first-child {
        margin-left: 0;
    }

    .toggle-radio {
        display: inline-flex;
        border: 1px solid var(--black8);
        border-radius: 4px;
    }

    .toggle-radio>input:checked+label {
        background: var(--blue);
        color: var(--white);
    }

    .toggle-radio>input+label:not(:last-of-type) {
        border-right: 1px solid #ccc
    }

    .toggle-radio>input[type=radio] {
        display: none
    }

    .toggle-radio>input[disabled]+label {
        opacity: .5
    }

    .toggle-radio>input[disabled]+label:hover {
        cursor: not-allowed
    }

    .toggle-radio>input+label {
        display: inline-block;
        margin-bottom: 0;
        padding: 5px 10px;
        float: left;
        cursor: pointer;
        font-size: var(--font-size-small);
    }
</style>

<!-- Plugin UI -->
<div id="wrapper">
    <div>
        <!-- Section title -->
        <div class="section-title">Mode</div>
        <select id="mode" class="select-menu">
            <option value="1">Up - Down</option>
            <option value="2">Left - Right</option>
        </select>
    </div>
    <div class="mt-xxsmall">
        <div class="section-title">Spacing</div>
        <div class="flex flex-row">
            <div class="toggle-radio">
                <input type="radio" name="spacingGroup" id="default_Option1" value="8" checked>
                <label for="default_Option1">8</label>
                <input type="radio" name="spacingGroup" id="default_Option2" value="16">
                <label for="default_Option2">16</label>
                <input type="radio" name="spacingGroup" id="default_Option3" value="20">
                <label for="default_Option3">20</label>
                <input type="radio" name="spacingGroup" id="default_Option4" value="24">
                <label for="default_Option4">24</label>
                <input type="radio" name="spacingGroup" id="default_Option5" value="32">
                <label for="default_Option5">32</label>
                <input type="radio" name="spacingGroup" id="default_Option6" value="custom">
                <label for="default_Option6">Custom</label>
            </div>
            <div class="width-100 mt-xxsmall">
                <textarea id="customSpacing" class="textarea" rows="1" placeholder="Custom Value"></textarea>
            </div>
        </div>
    </div>
</div>
<div class="flex mt-small">
    <button class='button button--secondary' id="cancel">Cancel</button>
    <button class='button button--primary' id="apply">Apply</button>
</div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/figma-plugin-ds@1.0.1/dist/iife/figma-plugin-ds.js"></script>
<script>
    selectMenu.init(); //initiates the select menu component
    disclosure.init(); //initiates the disclosure component

    document.getElementById('cancel').onclick = (event) => {
        parent.postMessage({pluginMessage: {type: 'actionExit'}}, '*');
    };

    document.getElementById('apply').onclick = () => {
        const mode = document.getElementById('mode').value;
        var spacing = document.querySelector('input[name="spacingGroup"]:checked').value;
        if(spacing === 'custom'){
            // 預防textarea為空
            if (document.getElementById('customSpacing').value == ""){
                spacing = "8";
            } else {
                spacing = document.getElementById('customSpacing').value;
            }
        }
        parent.postMessage({pluginMessage: {type: 'actionApply', mode, spacing}}, '*');
    };

</script>